if [[ "$(scutil --get LocalHostName)" == "T001849997" ]]; then
	alias r='sudo darwin-rebuild switch --flake ".#m3-pro"'
else
	alias r='sudo darwin-rebuild switch'
fi

alias u='cd /etc/nix-darwin && git pull && r; cd -'

alias publicip='curl -4 -s ifconfig.co'
alias localip='ipconfig getifaddr en0'
alias scannet='ifconfig | grep broadcast | arp -a'

export VISUAL='code -w'
export EDITOR='code -w'

# --------------------------------------------------------------------------------------
# functions

# unquarantine files
quaran() {
	xattr -d com.apple.quarantine "$1"
}

sync_conflict() {
	find . -name "*.sync-conflict-*"
	find . -name "*.sync-conflict-*" -type f -delete
}

whatport() {
	sudo lsof -n -i4TCP:$1 | grep LISTEN
}

killport() {
	port=$(lsof -n -i4TCP:$1 | grep LISTEN | awk '{ print $2 }')
	if [ -z "${port}" ]; then
		echo "No process found listening on port $1"
	else
		kill -9 $port
	fi
}

w() {
	STONE="/System/Library/Desktop Pictures/Solid Colors/Stone.png"
	BLACK="/System/Library/Desktop Pictures/Solid Colors/Black.png"

	CURRENT_WALLPAPER=$(osascript -e 'tell application "System Events" to get picture of desktop 1')

	if [[ "$CURRENT_WALLPAPER" == "$STONE" ]]; then
			TARGET="$BLACK"
	else
			TARGET="$STONE"
	fi

	osascript -e "tell application \"System Events\" to tell every desktop to set picture to \"$TARGET\" as POSIX file"
}
